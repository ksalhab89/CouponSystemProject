# =============================================================================
# ENVIRONMENT VARIABLES - Required for Docker Compose
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# The .env file is gitignored and should NEVER be committed
# =============================================================================

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# MySQL Root Password (for docker-compose MySQL container only)
MYSQL_ROOT_PASSWORD=your_secure_root_password_min_16_chars

# Application Database Connection
DB_URL=jdbc:mysql://coupon-system-mysql:3306/couponsystem?serverTimezone=UTC
DB_USER=appuser
DB_PASSWORD=your_secure_db_password_min_16_chars

# Database Connection Pool Settings
DB_POOL_MIN_IDLE=5
DB_POOL_MAX_POOL_SIZE=20
DB_POOL_CONNECTION_TIMEOUT=30000

# =============================================================================
# JWT AUTHENTICATION CONFIGURATION
# =============================================================================

# CRITICAL: Change this to a random 256-bit secret (minimum 32 characters)
# Generate using: openssl rand -base64 32
JWT_SECRET=CHANGE_THIS_TO_A_RANDOM_256_BIT_SECRET_AT_LEAST_32_CHARS_LONG

# Token expiration times (in milliseconds)
JWT_ACCESS_TOKEN_EXPIRATION=3600000   # 1 hour (3600000 ms)
JWT_REFRESH_TOKEN_EXPIRATION=86400000 # 24 hours (86400000 ms)

# =============================================================================
# ADMIN ACCOUNT
# =============================================================================

# Admin Email
ADMIN_EMAIL=admin@yourcompany.com

# Admin Password
# Option 1: Plain password (will be hashed with bcrypt on startup)
ADMIN_PASSWORD=your_secure_admin_password_min_16_chars

# Option 2: Pre-hashed bcrypt password (recommended for production)
# Generate using:
#   java -cp target/CouponSystemProject-1.0-SNAPSHOT-jar-with-dependencies.jar \
#     com.jhf.coupon.backend.security.PasswordHasher YourPassword
# Example: ADMIN_PASSWORD=$2a$12$hashed_password_here

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# REST API Port
SERVER_PORT=8080

# Prometheus Metrics Port
METRICS_PORT=9090

# Logging Level (DEBUG, INFO, WARN, ERROR)
# Use INFO for production, DEBUG for troubleshooting
LOGGING_LEVEL=INFO

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Account Lockout Settings
ACCOUNT_LOCKOUT_MAX_ATTEMPTS=5              # Lock account after 5 failed login attempts
ACCOUNT_LOCKOUT_DURATION_MINUTES=30         # Lock for 30 minutes
ACCOUNT_LOCKOUT_ADMIN_ENABLED=false         # Don't lock admin accounts (recommended)

# Password Security
PASSWORD_BCRYPT_STRENGTH=12                 # bcrypt rounds (12 = 4096 iterations)

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Allowed Origins for CORS (comma-separated list)
# Production example:
# CORS_ALLOWED_ORIGINS=https://yourapp.com,https://www.yourapp.com

# Development example (React default port 3000, Vite default port 5173):
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# =============================================================================
# RATE LIMITING
# =============================================================================

# Authentication Endpoints (/api/v1/auth/*)
RATE_LIMIT_AUTH_CAPACITY=5                  # Max 5 requests
RATE_LIMIT_AUTH_REFILL_RATE_MINUTES=1       # Per minute

# General API Endpoints
RATE_LIMIT_GENERAL_CAPACITY=100             # Max 100 requests
RATE_LIMIT_GENERAL_REFILL_RATE_MINUTES=1    # Per minute

# =============================================================================
# SECURITY REQUIREMENTS
# =============================================================================
# 1. CRITICAL: Change JWT_SECRET to a unique random value (minimum 32 chars)
# 2. Use strong passwords (minimum 16 characters)
# 3. Mix uppercase, lowercase, numbers, and special characters
# 4. Never reuse passwords across environments
# 5. Rotate passwords every 90 days
# 6. For production, use pre-hashed bcrypt admin password
#
# Example strong password: mK9#vL2$nP8@qR5&wX3!zY4%tQ6^
# Example JWT secret: kR9$mL3#nP7@qV2!wX5&yZ8%tS4^aB6*
# Example bcrypt hash: $2a$12$N0LS1Z3Q5nY6LQaVCf6JXO7K...
# =============================================================================

# =============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production, verify:
# [ ] JWT_SECRET changed from default (minimum 32 characters)
# [ ] ADMIN_PASSWORD changed from default
# [ ] DB_PASSWORD and MYSQL_ROOT_PASSWORD are strong
# [ ] CORS_ALLOWED_ORIGINS configured for your frontend domains
# [ ] SSL/TLS enabled (reverse proxy or Spring Boot SSL)
# [ ] Logging level set to INFO (not DEBUG)
# [ ] Rate limits configured appropriately for your traffic
# [ ] Database backups scheduled
# [ ] Health checks monitored (/actuator/health)
# [ ] Prometheus metrics monitored (/metrics)
# =============================================================================

# =============================================================================
# NOTES
# =============================================================================
# - DB_URL uses 'coupon-system-mysql' as hostname (Docker service name)
# - Ports 8080 (API) and 9090 (metrics) are exposed by docker-compose
# - MySQL port 3306 exposed for development only (remove in production)
# - All default values have fallbacks in docker-compose.yml
# - See docs/DEPLOYMENT.md for complete production setup guide
# =============================================================================
